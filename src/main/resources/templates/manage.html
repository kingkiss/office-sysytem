
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>OFFICE 云物品</title>

    <link rel="stylesheet" href="my/bootstrap.min.css">
    <link rel="stylesheet" href="my/mystyle.css">
    <script src="my/jquery-3.1.1.min.js"></script>
    <script src="my/vue.js"></script>
    <script src="my/bootstrap.min.js"></script>
    <script src="my/axios.min.js"></script>
    <!---<link rel="shortcut icon" href="pic/officeicon.ico">  -->
</head>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <!--<div class="row">
        <div class="col-md-10">
            <p class="navbar-text" style="font-family: Microsoft YaHei;font-size: 18px">OFFICE 云管理</p>
        </div>
        <div id="user" class="col-md-2" style="padding-top: 4.5px">
            <div class="btn-group">
                <img src="pic/user_icon.png" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <button class="navbar-text" style="font-family: Microsoft YaHei;font-size: 15px;background-color: #EC3851">{{ user_truename }}</button>
                <ul class="dropdown-menu">
                    <li><img src="pic/user2_icon.png"></li>
                    <li class="dropdown-header" style="color: #8a8a8a">{{ user_truename }}</li>
                    <li class="dropdown-header" style="color: #8a8a8a">{{ user_name }}</li>
                    <li role="separator" class="divider"></li>
                    <li><a data-toggle="modal" data-target="#userInfo">个人详情</a></li>
                    <li><a href="http://localhost:8080/loginout">注销</a></li>
                </ul>
            </div>

        </div>
    </div>-->

    <div class="container-fluid" id="user">
        <div class="navbar-header">
            <a class="navbar-brand" href="manage_officelist" style="font-family: Microsoft YaHei;font-size: 20px;color: #fff">OFFICE 云管理</a>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right" style="margin-right: 50px;">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"
                       style="font-family: Microsoft YaHei;font-size: 20px;color: #fff">{{ user_truename }}</span></a>
                    <ul class="dropdown-menu">
                        <li><img src="pic/user2_icon.png"></li>
                        <li class="dropdown-header" style="color: #8a8a8a">{{ user_truename }}</li>
                        <li class="dropdown-header" style="color: #8a8a8a">{{ user_name }}</li>
                        <li role="separator" class="divider"></li>
                        <li><a data-toggle="modal" data-target="#userInfo">个人详情</a></li>
                        <li><a href="http://localhost:8080/loginout">注销</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>


</nav>

<body style="padding-top: 51px;">

<div class="left-nav">
    <div class="list-group" id="fun_show_left">
        <a href="manage_officelist" th:class="${isOfficeList}?'list-group-item list-item-active':'list-group-item'">物品申请</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3">物品管理</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3">物品类型</a>
        <a href="manage_userInfo" th:class="${isUserInfo}?'list-group-item list-item-active':'list-group-item'" v-show="userdata.user_authority >= 7">用户管理</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3">申请审核</a>
        <a href="#" class="list-group-item">申请记录</a>
        <a href="#" class="list-group-item">借入记录</a>
        <a href="#" class="list-group-item">归还记录</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3">使用统计</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 7">系统管理</a>
    </div>
</div>

<div class="rigth-nav">
    <div class="container" style="margin-left: 0;width: 85%;">
        <!--用户管理模块（用户查询、修改、删除、添加）-->
        <div th:include="manage_userInfo :: m_userInfo" th:if="${isUserInfo}"></div>
        <!--物品申请模块（物品查询、借入）-->
        <div th:include="manage_officelist :: m_officelist" th:if="${isOfficeList}"></div>
    </div>
</div>

<!-- 个人信息Modal框   用户个人信息查看和修改-->
<div th:include="modal :: userModal"></div>

<!-- 添加用户用modal框 -->
<div th:include="modal :: addUserModal"></div>

<!-- 用户信息修改用modal框 -->
<div th:include="modal :: userChangeModal"></div>

<!--申请物品modal框-->
<div th:include="modal :: applyModal"></div>

</body>
<script src="my/manage_userInfo.js"></script>
<script>
/*    $('.list-group-item').click(function () {
        $(this).siblings('.list-group-item').removeClass('list-item-active');
        $(this).addClass('list-item-active');
    });*/

    /*文具事务用品数据表格stationery_category(m_officelist框中数据)*/
    var stationery = new Vue({
        el:'#stationery_category',
        data:{
            message,
            tempProductInfo,
            searchStationeryProduct:'',
            stationeries:[],
            pagination:{},
        },
        mounted:function () {
            this.stationeryList(1);

        },
        methods:{
            stationeryList:function (start) {
                var url = "http://localhost:8080/allStationery";
                var self = this;
                axios.get(url,{params:{start:start}}).then(function(response){
                    var result = response.data;
                    self.stationeries = result.products;
                    self.pagination = result.page;
                })
            },
            jumpByNumber:function (start) {
                var self = this;
                if( start != self.pagination.pageNum ){
                    self.stationeryList(start);
                };
            },
            jumpPage:function (page) {
                var self = this;
                if( page == 'pre' && self.pagination.hasPreviousPage ){
                    self.stationeryList( self.pagination.prePage );
                }else if( page == 'next' && self.pagination.hasNextPage ){
                    self.stationeryList( self.pagination.nextPage );
                };
            },
            searchStationery:function () {
                var self = this;
                var url = "http://localhost:8080/SearchOffice";
                axios.get(url,{params:{type:'文具事务用品',product:self.searchStationeryProduct}}).then(function(response){
                    var result = response.data;
                    self.stationeries = result.SearchProduct;
                    self.pagination = result.page;
                })
            },
            applyStationeryProduct:function (product) {
                var self = this;
                self.tempProductInfo.product_name = product.product_name;
                self.tempProductInfo.product_num = product.product_num;
                self.tempProductInfo.product_price = product.product_price;
                self.tempProductInfo.product_type = product.product_type;
                self.tempProductInfo.product_id = product.product_id;
            }
        }

    });

    /*办公耗材数据表格consumable_category(m_officelist框中数据)*/
    var consumable = new Vue({
        el:'#consumable_category',
        data:{
            message,
            tempProductInfo,
            searchConsumableProduct:'',
            consumables:[],
            pagination:{},
        },
        mounted:function () {
            this.consumableList(1)
        },
        methods:{
            consumableList:function (start) {
                var url = "http://localhost:8080/allConsumable";
                var self = this;
                axios.get(url,{params:{start:start}}).then(function(response){
                    var result = response.data;
                    self.consumables = result.products;
                    self.pagination = result.page;
                })
            },
            jumpByNumber:function (start) {
                var self = this;
                if( start != self.pagination.pageNum ){
                    self.consumableList(start);
                };
            },
            jumpPage:function (page) {
                var self = this;
                if( page == 'pre' && self.pagination.hasPreviousPage ){
                    self.consumableList( self.pagination.prePage );
                }else if( page == 'next' && self.pagination.hasNextPage ){
                    self.consumableList( self.pagination.nextPage );
                };
            },
            searchConsumable:function () {
                var self = this;
                var url = "http://localhost:8080/SearchOffice";
                axios.get(url,{params:{type:'办公耗材',product:self.searchConsumableProduct}}).then(function(response){
                    var result = response.data;
                    self.consumables = result.SearchProduct;
                    self.pagination = result.page;
                })
            },
            applyConsumableProduct:function (product) {
                var self = this;
                self.tempProductInfo.product_name = product.product_name;
                self.tempProductInfo.product_num = product.product_num;
                self.tempProductInfo.product_price = product.product_price;
                self.tempProductInfo.product_type = product.product_type;
                self.tempProductInfo.product_id = product.product_id;
            }
        }
    });

    /*办公设备数据表格equipment_category(m_officelist框中数据)*/
    var equipment = new Vue({
        el:'#equipment_category',
        data:{
            message,
            tempProductInfo,
            searchEquipmentProduct:'',
            equipments:[],
            pagination:{},
        },
        mounted:function () {
            this.equipmentList(1);
        },
        methods:{
            equipmentList:function (start) {
                var url = "http://localhost:8080/allEquipment";
                var self = this;
                axios.get(url,{params:{start:start}}).then(function(response){
                    var result = response.data;
                    self.equipments = result.products;
                    self.pagination = result.page;
                })
            },
            jumpByNumber:function (start) {
                var self = this;
                if( start != self.pagination.pageNum ){
                    self.equipmentList(start);
                };
            },
            jumpPage:function (page) {
                var self = this;
                if( page == 'pre' && self.pagination.hasPreviousPage ){
                    self.equipmentList( self.pagination.prePage );
                }else if( page == 'next' && self.pagination.hasNextPage ){
                    self.equipmentList( self.pagination.nextPage );
                };
            },
            searchEquipment:function () {
                var self = this;
                var url = "http://localhost:8080/SearchOffice";
                axios.get(url,{params:{type:'办公设备',product:self.searchEquipmentProduct}}).then(function(response){
                    var result = response.data;
                    self.equipments = result.SearchProduct;
                    self.pagination = result.page;
                })
            },
            applyEquipmentProduct:function (product) {
                var self = this;
                self.tempProductInfo.product_name = product.product_name;
                self.tempProductInfo.product_num = product.product_num;
                self.tempProductInfo.product_price = product.product_price;
                self.tempProductInfo.product_type = product.product_type;
                self.tempProductInfo.product_id = product.product_id;
            }
        }
    });

    /*物品申请modal框数据处理*/
    var m_officeApplyModal = new Vue({
        el:'#applyModal',
        data:{
            tempProductInfo,
            userdata,
            message,
        },
        methods:{
            submitApply:function () {
                var self = this;
                var url = 'http://localhost:8080/addApply';
                var nowDate = new Date();
                var param = {
                    apply_user_id:userdata.user_id,
                    apply_product_id:tempProductInfo.product_id,
                    apply_num:tempProductInfo.apply_num,
                    apply_time:nowDate.toLocaleDateString(),
                };
                axios.post(url,param).then(function (response) {
                    var result = response.data;
                    if(result.result){
                        $('#addApplyS').removeClass('hide').addClass('in');
                        setTimeout(function(){$('#addApplyS').removeClass('in').addClass('hide');$('#applyModal').modal('toggle');location.reload();},1500);
                    }else{
                        $('#addApplyS').removeClass('hide').addClass('in');
                        setTimeout(function(){$('#addApplyS').removeClass('in').addClass('hide')},3000);
                    }
                })
            }
        }
    })
</script>

</html>