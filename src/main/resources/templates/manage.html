
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>OFFICE 云物品</title>

    <link rel="stylesheet" href="my/bootstrap.min.css">
    <link rel="stylesheet" href="my/mystyle.css">
    <script src="my/jquery-3.1.1.min.js"></script>
    <script src="my/vue.js"></script>
    <script src="my/bootstrap.min.js"></script>
    <script src="my/axios.min.js"></script>
    <!---<link rel="shortcut icon" href="pic/officeicon.ico">  -->
</head>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="row">
        <div class="col-md-10">
            <p class="navbar-text" style="font-family: Microsoft YaHei;font-size: 18px">OFFICE 云管理</p>
        </div>
        <div id="user" class="col-md-2" style="padding-top: 4.5px">
            <div class="btn-group">
                <img src="pic/user_icon.png" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <p class="navbar-text" style="font-family: Microsoft YaHei;font-size: 15px">{{ user_truename }}</p>
                <ul class="dropdown-menu">
                    <li><img src="pic/user2_icon.png"></li>
                    <li style="color: #8a8a8a">{{ user_truename }}</li>
                    <li style="color: #8a8a8a">{{ user_name }}</li>
                    <li role="separator" class="divider"></li>
                    <li><a data-toggle="modal" data-target="#userInfo">个人详情</a></li>
                    <li><a href="http://localhost:8080/loginout">注销</a></li>
                </ul>
            </div>

        </div>
    </div>
</nav>

<body style="padding-top: 55px;">
<div id="fun_show" class="left-nav">
    <div class="list-group">
        <a href="#" class="list-group-item " v-bind:class="{ 'list-item-active':m_office }">物品分类</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3" v-bind:class="{ 'list-item-active':m_officeInfo }">管理物品</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 7" v-bind:class="{ 'list-item-active':m_userInfo }">用户管理</a>
        <a href="#" class="list-group-item" v-show="userdata.user_authority >= 3" v-bind:class="{ 'list-item-active':m_applyCheck }">申请审核</a>
        <a href="#" class="list-group-item" v-bind:class="{ 'list-item-active':m_applylist }">申请记录</a>
        <a href="#" class="list-group-item" v-bind:class="{ 'list-item-active':m_borrowlist }">借入记录</a>
        <a href="#" class="list-group-item" v-bind:class="{ 'list-item-active':m_returnlist }">归还记录</a>
        <a href="#" class="list-group-item" v-bind:class="{ 'list-item-active':m_usedata }">使用统计</a>

    </div>
</div>

<div class="rigth-nav" style="margin-top: 10px">
    <div class="container">
        <div class="panel panel-default" id="allUser">
            <div class="panel-heading">
                用户管理
            </div>
            <div class="panel-body">
                <button type="button" class="btn btn-primary">添加用户</button>
            </div>

            <table class="table table-hover table-condensed">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>姓名</th>
                    <th>部门</th>
                    <th>邮箱</th>
                    <th>电话</th>
                    <th>职能</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="user in users">
                    <th scope="row">{{ user.user_id }}</th>
                    <td>{{ user.user_truename }}</td>
                    <td>{{ user.user_department }}</td>
                    <td>{{ user.user_name }}</td>
                    <td>{{ user.user_phone }}</td>
                    <td v-if="user.user_authority == 7">管理员</td>
                    <td v-else-if="user.user_authority == 3">财务人员</td>
                    <td v-else>普通员工</td>
                    <td>
                        <button type="button" class="btn btn-default btn-sm">修改</button>
                        <button type="button" class="btn btn-danger btn-sm">删除</button>
                    </td>
                </tr>

                </tbody>
            </table>

            <div class="panel-footer">
                <!--分页导航栏-->
                <nav aria-label="Page navigation" style="text-align: center">
                    <ul class="pagination">
                        <li :class="{ 'disabled': pagination.pageNum==1 }">
                            <a href="#" aria-label="Previous" @click="jumpPage('pre')" >
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <li v-for="i in pagination.navigatepageNums" :class="{ 'active': pagination.pageNum==i }"><a href="#" @click="jumpByNumber(i)">{{ i }}</a></li>
                        <li :class="{ 'disabled': pagination.pageNum==pagination.pages }">
                            <a href="#" aria-label="Next" @click="jumpPage('next')">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

<div th:include="modal :: userModal"></div>

</body>
<script>
    $('.list-group-item').click(function () {
        $(this).siblings('.list-group-item').removeClass('list-item-active');
        $(this).addClass('list-item-active');
    })


    /* m_userInfo框中数据流 */
    var m_user = new Vue({
        el:'#allUser',
        data:{
            users:[],
            pagination:{},
        },
        mounted:function () {
            this.userList(1)
        },
        methods:{
            userList:function (start) {
                var url = "http://localhost:8080/u?start="+start;
                var self = this;
                axios.get(url).then(function(response){
                    var result = response.data;
                    self.users = result.users;
                    self.pagination = result.page;
                    console.log(result.page);
                })
            },
            jumpByNumber:function (start) {
                var self = this;
                if( start != self.pagination.pageNum ){
                    self.userList(start);
                };
            },
            jumpPage:function (page) {
                var self = this;
                if( page == 'pre' && self.pagination.hasPreviousPage ){
                    self.userList( self.pagination.prePage );
                }else if( page == 'next' && self.pagination.hasNextPage ){
                    self.userList( self.pagination.nextPage );
                };
            }
        }

    })



</script>
<script src="my/manage_userInfo.js"></script>
</html>